{"version":3,"sources":["views/RestrictionCreator.js"],"names":["RestrictionCreator","monday","boardsForDropdown","addNewRestriction","getBoardColumnsAndGroups","validateNewRestriction","slug","console","log","useState","boardColumns","setBoardColumns","boardGroups","setBoardGroups","board","column","group","button","isLoading","setIsLoading","value","label","columns","restriction","setRestriction","useEffect","onSetColumnsAndGroups","a","groups","length","Swal","fire","title","html","icon","resetSelect","onAddNewRestriction","execute","message","type","timeout","onSetRestriction","kind","item","className","placeholder","options","onChange","isDisabled","isClearable","isMulti","size","Button","sizes","LARGE","loading","onClick","e","disabled"],"mappings":"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","file":"static/js/7.7a21e64c.chunk.js","sourcesContent":["import React, { useEffect, useMemo, useState } from \"react\";\r\nimport Button from \"monday-ui-react-core/dist/Button\";\r\nimport * as utils from \"../services/utils\";\r\nimport Select from \"react-select\";\r\nimport Loader from \"monday-ui-react-core/dist/Loader\";\r\nimport Swal from \"sweetalert2\";\r\n\r\nexport default function RestrictionCreator({\r\n  monday,\r\n  boardsForDropdown,\r\n  addNewRestriction,\r\n  getBoardColumnsAndGroups,\r\n  validateNewRestriction,\r\n  slug,\r\n}) {\r\n  console.log(`slug`, slug);\r\n  const [boardColumns, setBoardColumns] = useState();\r\n  const [boardGroups, setBoardGroups] = useState();\r\n  const [isLoading, setIsLoading] = useState({\r\n    board: false,\r\n    column: false,\r\n    group: false,\r\n    button: false,\r\n  });\r\n\r\n  const [restriction, setRestriction] = useState({\r\n    board: { value: null, label: \"Choose a board to restrict\" },\r\n    group: { value: null, label: \"Choose a group to restrict\" },\r\n    columns: [],\r\n  });\r\n  useEffect(() => {\r\n    if (restriction.board.value !== null) onSetColumnsAndGroups();\r\n  }, [restriction.board]);\r\n  const onSetColumnsAndGroups = async () => {\r\n    setIsLoading({ ...isLoading, column: true, group: true });\r\n    const { columns, groups } = await getBoardColumnsAndGroups(restriction);\r\n    console.log(`onSetColumnsAndGroups ->  columns, groups`, columns, groups);\r\n    // const hola = await getBoardColumnsAndGroups(restriction);\r\n    // // console.log(`onSetColumnsAndGroups -> hola`, hola);\r\n    // return;\r\n    if (!columns?.length) {\r\n      Swal.fire({\r\n        title: \"Oops!\",\r\n        html: `<p>It looks like you dont have any columns in <a href=\"https://${slug}.monday.com/boards/${restriction.board.value}\" target=\"_blank\">${restriction?.board?.label}</a>!</p> <p> Please choose a different board, or add columns on that board.</p>`,\r\n        icon: \"error\",\r\n      });\r\n      resetSelect();\r\n    }\r\n    setIsLoading({ ...isLoading, column: false });\r\n    setBoardColumns(columns);\r\n    setBoardGroups(groups);\r\n  };\r\n  const onAddNewRestriction = async () => {\r\n    if (validateNewRestriction(restriction, true)) {\r\n      setIsLoading({ ...isLoading, button: true });\r\n      await addNewRestriction(restriction);\r\n      setIsLoading({ ...isLoading, button: false });\r\n      resetSelect();\r\n      monday.execute(\"notice\", {\r\n        message: `congrats! New restriction was created at ${restriction.board.label}!`,\r\n        type: \"success\", // or \"error\" (red), or \"info\" (blue)\r\n        timeout: 10000,\r\n      });\r\n    } else console.log(\"not valid\");\r\n  };\r\n  const resetSelect = () => {\r\n    setRestriction({\r\n      board: { value: null, label: \"Choose a board to restrict\" },\r\n      group: { value: null, label: \"Choose a group to restrict\" },\r\n      columns: [],\r\n    });\r\n  };\r\n\r\n  const onSetRestriction = (kind, item) => {\r\n    // console.log(`onSetRestriction -> item`, item);\r\n    // console.log(`onSetRestriction -> kind`, kind);\r\n    if (kind === \"board\") {\r\n      setRestriction({ ...restriction, board: item });\r\n    } else if (kind === \"group\") {\r\n      setRestriction({ ...restriction, group: item });\r\n    } else if (kind === \"column\") {\r\n      setRestriction({ ...restriction, columns: item });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"create-restriction\">\r\n      <div className=\"selects\">\r\n        <label className=\"restriction-label\">\r\n          Board\r\n          {isLoading.board ? (\r\n            <div className=\"small-loader\">\r\n              <Loader />\r\n            </div>\r\n          ) : (\r\n            <Select\r\n              isLoading={isLoading.board}\r\n              placeholder=\"Choose board to restrict\"\r\n              className=\"restriction-select\"\r\n              options={boardsForDropdown}\r\n              onChange={(board) => onSetRestriction(\"board\", board)}\r\n              value={restriction.board}\r\n            />\r\n          )}\r\n        </label>\r\n        <label className=\"restriction-label\">\r\n          Groups\r\n          <Select\r\n            isLoading={isLoading.group}\r\n            placeholder=\"Choose board to restrict\"\r\n            className=\"restriction-select\"\r\n            isDisabled={!boardGroups?.length}\r\n            options={boardGroups}\r\n            onChange={(group) => onSetRestriction(\"group\", group)}\r\n            value={restriction.group}\r\n          />\r\n        </label>\r\n        <label\r\n          className=\"restriction-label\"\r\n          title={boardColumns?.length ? \"\" : \"Please choose a board first!\"}\r\n        >\r\n          Columns\r\n          <Select\r\n            placeholder=\"Choose column to restrict\"\r\n            className=\"restriction-select\"\r\n            onChange={(column) => onSetRestriction(\"column\", column)}\r\n            options={boardColumns}\r\n            isDisabled={!boardColumns?.length}\r\n            value={restriction?.columns}\r\n            isClearable\r\n            isMulti\r\n            isLoading={isLoading.column}\r\n          />\r\n        </label>\r\n      </div>\r\n      <div className=\"button-div\">\r\n        <Button\r\n          size={Button.sizes.LARGE}\r\n          loading={isLoading.button}\r\n          onClick={(e) => {\r\n            onAddNewRestriction(restriction);\r\n          }}\r\n          disabled={\r\n            !restriction?.board?.label ||\r\n            !restriction?.board?.value ||\r\n            !restriction?.columns?.length\r\n          }\r\n        >\r\n          Create\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"sourceRoot":""}