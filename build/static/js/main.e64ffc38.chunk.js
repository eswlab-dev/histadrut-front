(this["webpackJsonpmonday-integration-quickstart-app"]=this["webpackJsonpmonday-integration-quickstart-app"]||[]).push([[1],{19:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return v}));var r=n(2),a=n.n(r),c=n(6),o=n(10),u=n.n(o),i="https://histadrut-inters.herokuapp.com";function s(e){return l.apply(this,arguments)}function l(){return(l=Object(c.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h(t),console.log("addBoardRestriction -> filteredRestriction",n),e.next=4,u.a.post("".concat(i,"/restriction/board"),n);case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return p.apply(this,arguments)}function p(){return(p=Object(c.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.get("".concat(i,"/restriction/account/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e,t){return b.apply(this,arguments)}function b(){return(b=Object(c.a)(a.a.mark((function e(t,n){var r,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.account=n,r=h(t),console.log("editRestriction -> filteredRestriction",r),console.log("editRestriction -> restriction",t),e.next=6,u.a.put("".concat(i,"/restriction/board"),r);case 6:return c=e.sent,console.log("editRestriction -> edited",c),e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return m.apply(this,arguments)}function m(){return(m=Object(c.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t._id,e.next=3,u.a.delete("".concat(i,"/restriction/board/").concat(n));case 3:return r=e.sent,console.log("deleteRestriction -> deleted",r),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){var t={accountId:e.accountId||e.account,boardId:Number(e.board.value),columnIds:e.columns.map((function(e){return e.value})),_id:e._id};return console.log("filterRestriction -> filteredRestriction",t),t}},44:function(e,t,n){e.exports=n(95)},49:function(e,t,n){},51:function(e,t,n){},95:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(23),o=n.n(c),u=(n(49),n(12)),i=n(2),s=n.n(i),l=n(21),d=n(22),p=n(6),f=n(5),b=(n(51),n(42)),v=n.n(b),m=(n(66),n(30)),h=n.n(m),g=n(24),w=n.n(g),y=n(19),O=n(25),j=n(1),x=Object(r.lazy)((function(){return Promise.all([n.e(0),n.e(7)]).then(n.bind(null,141))})),k=Object(r.lazy)((function(){return Promise.all([n.e(0),n.e(6)]).then(n.bind(null,144))})),E=Object(r.lazy)((function(){return n.e(5).then(n.bind(null,142))})),R=Object(r.lazy)((function(){return n.e(4).then(n.bind(null,143))})),N=v()();function I(){var e=Object(r.useState)([]),t=Object(f.a)(e,2),n=t[0],c=t[1];console.log("App -> boards",n.length);var o=Object(r.useState)({accountId:null,slug:null}),i=Object(f.a)(o,2),b=i[0],v=i[1],m=Object(r.useState)(""),g=Object(f.a)(m,2),I=g[0],q=g[1],B=Object(r.useState)([]),S=Object(f.a)(B,2),C=S[0],_=S[1];Object(r.useEffect)((function(){q(window.location.hash.includes("create")?"create":"existing"),P(),console.log("useEffect ->  window.location",window.location),console.log("\u05d0\u05d4\u05d5\u05d1 \u05d0\u05ea \u05d4\u05de\u05dc\u05d0\u05db\u05d4")}),[]),Object(r.useEffect)((function(){b.accountId&&J()}),[b]),Object(r.useEffect)((function(){var e=null===n||void 0===n?void 0:n.filter((function(e){return!C.find((function(t){var n;return Number(null===t||void 0===t||null===(n=t.board)||void 0===n?void 0:n.value)===Number(null===e||void 0===e?void 0:e.id)}))}));c(e)}),[C]);var z=function(){var e=Object(p.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.columns.map((function(e){return null===e||void 0===e?void 0:e.value})),n=Object(d.a)({accountId:b.accountId},t),e.next=4,y.a(n);case 4:return e.sent,e.next=7,L([t]);case 7:r=e.sent,_([].concat(Object(l.a)(C),Object(l.a)(r)));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(p.a)(s.a.mark((function e(t){var n,r,a,c,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(null===(n=t.board)||void 0===n?void 0:n.value)){e.next=12;break}return r="query{\n          boards(ids:".concat(n.value,"){\n            columns{\n              id\n              type\n              title\n            }\n          }\n        }"),e.next=6,N.api(r);case 6:return a=e.sent,c=a.data.boards[0].columns,o=c.filter((function(e){return"Name"!==e.title&&!["pulse-updated","lookup","formula","columns-battery","button"].includes(e.type)})).map((function(e){return{value:e.id,label:e.title}})),e.abrupt("return",o);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.log("getBoardColumns -> err",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(p.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.d(b.accountId);case 2:return t=e.sent,e.next=5,Promise.all(t);case 5:return t=e.sent,e.next=8,L(t);case 8:n=e.sent,_(n);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Object(p.a)(s.a.mark((function e(t){var n,r,a,c,o,i,l,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("getRestrictionLabels -> restrictions",t),e.prev=1,n=[],r=Object(u.a)(t),e.prev=4,r.s();case 6:if((a=r.n()).done){e.next=18;break}return c=a.value,o="query{\n          boards(ids:".concat(c.boardId||c.board.value,"){\n            name\n            columns(ids:").concat(JSON.stringify(c.columnIds),"){\n              id\n              title\n            }\n          }\n        }"),e.next=11,N.api(o);case 11:i=e.sent,console.log("getRestrictionLabels -> res",i),l=i.data.boards[0].name,d=i.data.boards[0].columns.map((function(e){return{value:e.id,label:e.title}})),n.push({board:{value:Number(c.boardId),label:l},columns:d,_id:c._id});case 16:e.next=6;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(4),r.e(e.t0);case 23:return e.prev=23,r.f(),e.finish(23);case 26:return e.abrupt("return",n);case 29:e.prev=29,e.t1=e.catch(1),console.log("getRestrictionLabels -> error",e.t1);case 32:case"end":return e.stop()}}),e,null,[[1,29],[4,20,23,26]])})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(p.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"query{\n      account{\n        id\n        slug\n      }\n      boards(limit:2000){\n        name\n        id\n      }\n    }",e.next=3,N.api("query{\n      account{\n        id\n        slug\n      }\n      boards(limit:2000){\n        name\n        id\n      }\n    }");case 3:t=e.sent,v({accountId:Number(t.data.account.id),slug:t.data.account.slug}),n=t.data.boards,c(n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=Object(r.useMemo)((function(){if(null===n||void 0===n?void 0:n.length)return n.map((function(e){return{label:e.name,value:e.id}}))}),[n]),D=function(e){console.log("validateNewRestriction -> restriction",e);var t=null===e||void 0===e?void 0:e.board,n=t.label,r=t.value,a=e.columns;return!!(n&&r&&a.length)||(h.a.fire({title:"Couldn't add restriction",text:"some columns are missing",icon:"warning",returnFocus:!0,allowEnterKey:!0,allowEscapeKey:!0}),!1)};return a.a.createElement(r.Suspense,{fallback:a.a.createElement("div",{className:"loader-div"},a.a.createElement("div",{className:"loader"},a.a.createElement(w.a,null)))},a.a.createElement("div",{className:"App"},a.a.createElement(O.a,null,a.a.createElement(E,{currentNav:I,setCurrentNav:q}),a.a.createElement(j.c,null,a.a.createElement(j.a,{path:"/create",element:a.a.createElement(x,{boardsForDropdown:A,boards:n,monday:N,addNewRestriction:z,getBoardColumns:F,validateNewRestriction:D,slug:null===b||void 0===b?void 0:b.slug})}),a.a.createElement(j.a,{path:"/",element:a.a.createElement(k,{boardsForDropdown:A,getBoardColumns:F,account:null===b||void 0===b?void 0:b.accountId,restrictions:C,setRestrictions:_,validateNewRestriction:D,getRestrictions:J,monday:N})})),a.a.createElement(R,null))))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[44,2,3]]]);
//# sourceMappingURL=main.e64ffc38.chunk.js.map