(this["webpackJsonpmonday-integration-quickstart-app"]=this["webpackJsonpmonday-integration-quickstart-app"]||[]).push([[1],{19:function(e,n,t){"use strict";t.d(n,"a",(function(){return s})),t.d(n,"d",(function(){return d})),t.d(n,"c",(function(){return b})),t.d(n,"b",(function(){return v}));var r=t(2),a=t.n(r),o=t(6),c=t(10),u=t.n(c),i="https://histadrut-inters.herokuapp.com";function s(e){return l.apply(this,arguments)}function l(){return(l=Object(o.a)(a.a.mark((function e(n){var t,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g(n),console.log("addBoardRestriction -> filteredRestriction",t),e.next=4,u.a.post("".concat(i,"/restriction/board"),t);case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return p.apply(this,arguments)}function p(){return(p=Object(o.a)(a.a.mark((function e(n){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.get("".concat(i,"/restriction/account/").concat(n));case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e,n){return f.apply(this,arguments)}function f(){return(f=Object(o.a)(a.a.mark((function e(n,t){var r,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.account=t,r=g(n),console.log("editRestriction -> filteredRestriction",r),console.log("editRestriction -> restriction",n),e.next=6,u.a.put("".concat(i,"/restriction/board"),r);case 6:return o=e.sent,console.log("editRestriction -> edited",o),e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return m.apply(this,arguments)}function m(){return(m=Object(o.a)(a.a.mark((function e(n){var t,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n._id,e.next=3,u.a.delete("".concat(i,"/restriction/board/").concat(t));case 3:return r=e.sent,console.log("deleteRestriction -> deleted",r),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){var n={accountId:e.accountId||e.account,boardId:Number(e.board.value),columnIds:e.columns.map((function(e){return e.value})),groupId:e.group.value,_id:e._id};return console.log("filterRestriction -> filteredRestriction",n),n}},44:function(e,n,t){e.exports=t(95)},49:function(e,n,t){},51:function(e,n,t){},95:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),o=t(25),c=t.n(o),u=(t(49),t(12)),i=t(2),s=t.n(i),l=t(22),d=t(23),p=t(6),b=t(5),f=(t(51),t(42)),v=t.n(f),m=(t(66),t(21)),g=t.n(m),h=t(24),w=t.n(h),y=t(19),x=t(26),O=t(1),j=Object(r.lazy)((function(){return Promise.all([t.e(0),t.e(7)]).then(t.bind(null,141))})),E=Object(r.lazy)((function(){return Promise.all([t.e(0),t.e(6)]).then(t.bind(null,144))})),R=Object(r.lazy)((function(){return t.e(5).then(t.bind(null,142))})),k=Object(r.lazy)((function(){return t.e(4).then(t.bind(null,143))})),N=v()();function I(){var e=Object(r.useState)([]),n=Object(b.a)(e,2),t=n[0],o=n[1];console.log("App -> boards",t.length);var c=Object(r.useState)({accountId:null,slug:null}),i=Object(b.a)(c,2),f=i[0],v=i[1],m=Object(r.useState)(""),h=Object(b.a)(m,2),I=h[0],q=h[1],B=Object(r.useState)([]),C=Object(b.a)(B,2),S=C[0],A=C[1];Object(r.useEffect)((function(){q(window.location.hash.includes("create")?"create":"existing"),J(),console.table({href:window.location.href,NODE_ENV:"production"}),console.log("\u05d0\u05d4\u05d5\u05d1 \u05d0\u05ea \u05d4\u05de\u05dc\u05d0\u05db\u05d4")}),[]),Object(r.useEffect)((function(){f.accountId&&F()}),[f]);var _=function(){var e=Object(p.a)(s.a.mark((function e(n){var t,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("addNewRestriction -> newRestriction",n),n.columns.map((function(e){return null===e||void 0===e?void 0:e.value})),t=Object(d.a)({accountId:f.accountId},n),e.next=5,y.a(t);case 5:return e.sent,e.next=8,G([n]);case 8:r=e.sent,console.log("addNewRestriction -> labeledRestriction",r),A([].concat(Object(l.a)(S),Object(l.a)(r)));case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),z=function(){var e=Object(p.a)(s.a.mark((function e(n){var t,r,a,o,c,u,i,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(null===(t=n.board)||void 0===t?void 0:t.value)){e.next=14;break}return r="query{\n          boards(ids:".concat(t.value,"){\n            groups{\n              id\n              title\n            }\n            columns{\n              id\n              type\n              title\n            }\n          }\n        }"),e.next=6,N.api(r);case 6:return a=e.sent,o=a.data.boards[0],c=o.columns,u=o.groups,console.log("getBoardColumnsAndGroups -> columns, groups",c,u),i=c.filter((function(e){return"Name"!==e.title&&!["pulse-updated","lookup","formula","columns-battery","button"].includes(e.type)})).map((function(e){return{value:e.id,label:e.title}})),l=null===u||void 0===u?void 0:u.map((function(e){return{value:e.id,label:e.title}})),e.abrupt("return",{columns:i,groups:l});case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),console.log("getBoardColumnsAndGroups -> err",e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(n){return e.apply(this,arguments)}}(),F=function(){var e=Object(p.a)(s.a.mark((function e(){var n,t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.d(f.accountId);case 2:return n=e.sent,e.next=5,Promise.all(n);case 5:return n=e.sent,e.next=8,G(n);case 8:t=e.sent,A(t);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=Object(p.a)(s.a.mark((function e(n){var t,r,a,o,c,i,l,d,p,b,f,v,m;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("getRestrictionLabels -> restrictions",n),e.prev=1,t=[],r=Object(u.a)(n),e.prev=4,r.s();case 6:if((a=r.n()).done){e.next=22;break}return i=a.value,l=(null===i||void 0===i||null===(o=i.group)||void 0===o?void 0:o.value)||(null===i||void 0===i?void 0:i.groupId),d=(null===i||void 0===i||null===(c=i.columns)||void 0===c?void 0:c.map((function(e){return e.id||e.value})))||(null===i||void 0===i?void 0:i.columnIds),p="query{ \n          boards(ids:".concat(i.boardId||i.board.value,"){\n            name\n            groups(ids:[").concat(JSON.stringify(l),"]){\n              title\n              id\n            }\n            columns(ids:").concat(JSON.stringify(d),"){\n              id\n              title\n            }\n          }\n        }"),console.log("getRestrictionLabels -> query",p),e.next=14,N.api(p);case 14:b=e.sent,console.log("getRestrictionLabels -> res",b.data.boards[0]),f=b.data.boards[0].name,v={label:b.data.boards[0].groups[0].title,value:i.groupId},m=b.data.boards[0].columns.map((function(e){return{value:e.id,label:e.title}})),t.push({board:{value:Number(i.boardId),label:f},columns:m,group:v,_id:i._id});case 20:e.next=6;break;case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(4),r.e(e.t0);case 27:return e.prev=27,r.f(),e.finish(27);case 30:return e.abrupt("return",t);case 33:e.prev=33,e.t1=e.catch(1),console.log("getRestrictionLabels -> error",e.t1);case 36:case"end":return e.stop()}}),e,null,[[1,33],[4,24,27,30]])})));return function(n){return e.apply(this,arguments)}}(),J=function(){var e=Object(p.a)(s.a.mark((function e(){var n,t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"query{\n      account{\n        id\n        slug\n      }\n      boards(limit:2000){\n        name\n        id\n      }\n    }",e.next=3,N.api("query{\n      account{\n        id\n        slug\n      }\n      boards(limit:2000){\n        name\n        id\n      }\n    }");case 3:n=e.sent,v({accountId:Number(n.data.account.id),slug:n.data.account.slug}),t=n.data.boards,o(t);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),K=Object(r.useMemo)((function(){if(null===t||void 0===t?void 0:t.length)return t.map((function(e){return{label:e.name,value:e.id}}))}),[t]),L=function(e,n){console.log("validateNewRestriction -> isNew",n),console.log("validateNewRestriction -> restriction",e);var t=e.board,r=e.group,a=e.columns;if(t.label&&t.value&&r.label&&r.value&&a.length){var o=D(e)&&n;return console.log("validateNewRestriction -> isExists",o),!o||(g.a.fire({title:"Couldn't add restriction",html:"<p>You already have an existing restriction on <b>".concat(e.group.label,"</b> group in <b>").concat(e.board.label,"</b> board</p>"),icon:"error",returnFocus:!0,allowEnterKey:!0,allowEscapeKey:!0}),!1)}return g.a.fire({title:"Couldn't add restriction",text:"some columns are missing",icon:"error",returnFocus:!0,allowEnterKey:!0,allowEscapeKey:!0}),!1},D=function(e){console.log("checkExistence -> restriction",e);var n=S.find((function(n){return Number(n.board.value)===Number(e.board.value)&&n.group.value===e.group.value}));return console.log("existing -> existing",n),!!n};return a.a.createElement(r.Suspense,{fallback:a.a.createElement("div",{className:"loader-div"},a.a.createElement("div",{className:"loader"},a.a.createElement(w.a,null)))},a.a.createElement("div",{className:"App"},a.a.createElement(x.a,null,a.a.createElement(R,{currentNav:I,setCurrentNav:q}),a.a.createElement(O.c,null,a.a.createElement(O.a,{path:"/create",element:a.a.createElement(j,{boardsForDropdown:K,boards:t,monday:N,addNewRestriction:_,getBoardColumnsAndGroups:z,validateNewRestriction:L,slug:null===f||void 0===f?void 0:f.slug})}),a.a.createElement(O.a,{path:"/",element:a.a.createElement(E,{boardsForDropdown:K,getBoardColumnsAndGroups:z,account:null===f||void 0===f?void 0:f.accountId,restrictions:S,setRestrictions:A,validateNewRestriction:L,getRestrictions:F,monday:N})})),a.a.createElement(k,null))))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(a.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[44,2,3]]]);
//# sourceMappingURL=main.4be577d9.chunk.js.map